<div class="p-1 py-5 min-h-screen">
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>

    <div class="mb-2">
        <p-panel header="Cargos" styleClass="custom-panel-header shadow-xl rounded-xl">
            <div class="aligned-content-container">
                <div class="mb-2">
                    <p-toolbar styleClass="mb-4 surface-card border-none px-4 align-to-table">
                        <div class="p-toolbar-group-start">
                            <button type="button" pRipple 
                                class="p-button p-button-sm p-button-primary" 
                                (click)="agregarCargo()"
                                [disabled]="!!editingCargo" 
                                pTooltip="Agregar Cargo">
                                <span class="pi pi-plus"></span>
                            </button>
                        </div>

                        <div class="table-controls-header flex justify-content-end align-items-center pr-1">
                            <div class="flex align-items-center">
                                <label style="margin-right: 0.4rem; font-size: 15px;" for="rowsPerPageTable">Filas por
                                    p치gina:
                                </label>
                                <p-dropdown id="rowsPerPageTable" [options]="[10, 20, 40]" [(ngModel)]="rowsPerPage"
                                    placeholder="10" styleClass="p-button-sm w-16 text-center">
                                </p-dropdown>
                            </div>
                        </div>
                    </p-toolbar>

                </div>

                <div class="px-4">
                    <p-table [value]="cargos" [rows]="rowsPerPage" [paginator]="true" responsiveLayout="scroll"
                        styleClass="p-datatable-sm p-datatable-striped p-datatable-gridlines cargo-table">
                        <ng-template pTemplate="header">
                            <tr>
                                <th style="width: auto; text-align: center;">C칩digo</th>
                                <th style="width: auto; text-align: center;">Descripci칩n</th>
                                <th style="width: auto; text-align: center;">Activo</th>
                                <th style="width: auto; text-align: center;">Acciones</th>
                            </tr>
                        </ng-template>

                        <ng-template pTemplate="body" let-cargo>
                            <tr>
                                <td class="text-center">
                                    <div *ngIf="editingCargo?.pla51codigo === cargo.pla51codigo; else displayCodigo">
                                        <input pInputText type="text" [(ngModel)]="editingCargo!.pla51codigo"
                                            placeholder="C칩digo" class="w-full text-sm text-center font-bold"
                                            [disabled]="!isAddMode" style="text-transform: uppercase;" />
                                    </div>
                                    <ng-template #displayCodigo>
                                        {{ cargo.pla51codigo.startsWith('TEMP-') ? '---' : cargo.pla51codigo }}
                                    </ng-template>
                                </td>

                                <td class="text-center">
                                    <div
                                        *ngIf="editingCargo?.pla51codigo === cargo.pla51codigo; else displayDescripcion">
                                        <input pInputText type="text" [(ngModel)]="editingCargo!.pla51descripcion"
                                            class="w-full text-sm text-left" />
                                    </div>
                                    <ng-template #displayDescripcion>
                                        {{ cargo.pla51descripcion }}
                                    </ng-template>
                                </td>

                                <td class="text-center">
                                    <div
                                        *ngIf="editingCargo?.pla51codigo === cargo.pla51codigo; else displayActivoVisual">
                                        <p-checkbox [binary]="true"
                                            [(ngModel)]="editingCargo!.pla51flagactivo"></p-checkbox>
                                    </div>

                                    <ng-template #displayActivoVisual>
                                        <p-checkbox [binary]="true" [ngModel]="cargo.pla51flagactivo" [disabled]="true"
                                            [readonly]="true">
                                        </p-checkbox>
                                    </ng-template>
                                </td>

                                <td>
                                    <div class="flex justify-content-center gap-2">

                                        <div *ngIf="editingCargo?.pla51codigo === cargo.pla51codigo">
                                            <button type="button" pRipple 
                                                class="p-button p-button-sm p-button-success p-button-text"
                                                pTooltip="Guardar" 
                                                (click)="onRowGuardarEdicion(cargo)">
                                                <span class="pi pi-check"></span>
                                            </button>
                                            
                                            <button type="button" pRipple
                                                class="p-button p-button-sm p-button-danger p-button-text"
                                                pTooltip="Cancelar" 
                                                (click)="onRowCancelarEdicion(cargo)">
                                                <span class="pi pi-times"></span>
                                            </button>
                                        </div>

                                        <div *ngIf="editingCargo?.pla51codigo !== cargo.pla51codigo">
                                            <button type="button" pRipple
                                                class="p-button p-button-sm p-button-info p-button-text" 
                                                pTooltip="Editar"
                                                (click)="onRowEditarCargo(cargo)" 
                                                [disabled]="!!editingCargo">
                                                <span class="pi pi-pencil"></span>
                                            </button>
                                            
                                            <button type="button" pRipple
                                                class="p-button p-button-sm p-button-danger p-button-text"
                                                pTooltip="Eliminar" 
                                                (click)="eliminarCargo(cargo)"
                                                [disabled]="!!editingCargo">
                                                <span class="pi pi-trash"></span>
                                            </button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </ng-template>

                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td colspan="4" style="text-align: center;">
                                    No se encontraron cargos.
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </p-panel>
    </div>
</div>